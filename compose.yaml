name: goobcontrol

services:
  goobcontrol:
    image: ghcr.io/gooberspace/goobcontrol:${GOOB_IMAGE_TAG:-latest}
    environment:
      GOOB_DATABASE_USER: ${GOOB_POSTGRES_USER:-goobcontrol}
      GOOB_DATABASE_HOST: ${GOOB_POSTGRES_HOST:-postgres:5432}
      GOOB_DATABASE_DATABASE: ${GOOB_POSTGRES_USER:-goobcontrol}
      GOOB_DATABASE_PASSWORD: ${GOOB_POSTGRES_PASSWORD:?Set a password for postgres with GOOB_POSTGRES_PASSWORD}
      GOOB_DISCORD_TOKEN: ${GOOB_DISCORD_TOKEN:?Set your discord token with GOOB_DISCORD_TOKEN}
      GOOB_BOT_PRIVATEGUILDS: ${GOOB_BOT_PRIVATEGUILDS}
      GOOB_BOT_DEBUG: ${GOOB_BOT_DEBUG}
      # Default Postgres container comes with TLS disabled, therefore we default to true in the docker compose
      GOOB_DATABASE_INSECURE: ${GOOB_DATABASE_INSECURE:-true}
  postgres:
    image: postgres:18-alpine
    environment:
      POSTGRES_PASSWORD: ${GOOB_POSTGRES_PASSWORD:?Set a password for postgres with GOOB_POSTGRES_PASSWORD}
      POSTGRES_USER: ${GOOB_POSTGRES_USER:-goobcontrol}
      POSTGRES_DB: ${GOOB_POSTGRES_DB:-goobcontrol}
      POSTGRES_INSECURE: ${GOOB_POSTGRES_INSECURE:-true}